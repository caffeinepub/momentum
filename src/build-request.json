{
  "kind": "build_request",
  "title": "Fix strike count update logic for routine reset buttons",
  "projectName": "Routine Tracker",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the backend strike count update logic in the nextDayReset function so that when 'Next Day Reset' is clicked, checked routines increment their strike count by 1 and unchecked routines reset their strike count to 0, with all checkboxes unchecked after the operation",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-14",
          "msg-16"
        ],
        "quotes": [
          "Strike count not updating properly after reset - only works correctly on first routine creation",
          "Next Day Reset: Checked routines get +1 strike, unchecked routines reset to 0, all checkboxes uncheck"
        ]
      },
      "acceptanceCriteria": [
        "After clicking 'Next Day Reset', checked routines have their strike count incremented by 1",
        "After clicking 'Next Day Reset', unchecked routines have their strike count reset to 0",
        "All routine checkboxes are unchecked after the reset operation",
        "Strike count updates persist correctly across multiple reset operations, not just on first routine creation"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Fix the backend strike count update logic in the skippedDayReset function so that when 'Skipped Day Reset' is clicked, all routine strike counts reset to 0 and all checkboxes are unchecked",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-14",
          "msg-16"
        ],
        "quotes": [
          "'skipped day' button reset all strike counts to 0 (to acknowledge missing a day) then just uncheck all boxes",
          "Skipped Day Reset: All strikes reset to 0, all uncheck"
        ]
      },
      "acceptanceCriteria": [
        "After clicking 'Skipped Day Reset', all routine strike counts are set to 0 regardless of checked state",
        "All routine checkboxes are unchecked after the reset operation",
        "Strike count updates persist correctly across multiple reset operations"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Preserve the existing frontend preview behavior where checking a routine shows strike count + 1 in the badge and unchecking shows the current strike count, with no backend calls during check/uncheck actions",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-14"
        ],
        "quotes": [
          "When a routine is checked: Badge shows strike count + 1 (preview of what it will be after reset)",
          "When a routine is unchecked: Badge shows the current strike count (no change preview)"
        ]
      },
      "acceptanceCriteria": [
        "Checking a routine displays strike count + 1 in the badge as a preview",
        "Unchecking a routine displays the current strike count in the badge",
        "No backend calls are made during check/uncheck actions",
        "Preview behavior updates instantly without waiting for backend responses"
      ]
    }
  ],
  "constraints": [
    "Keep all existing UI elements and layout unchanged",
    "Preserve the 'Start new day' button in header that opens the reset popup",
    "Keep both 'Next Day Reset' and 'Skipped Day Reset' buttons in the popup",
    "Maintain all other existing functions and features",
    "Do not modify the frontend check/uncheck preview logic"
  ],
  "nonGoals": [
    "Adding new UI elements or redesigning existing components",
    "Changing the preview behavior for routine check/uncheck actions",
    "Modifying any features outside of the routine reset functionality",
    "Adding new reset modes or buttons"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}