@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        --radius: 0.75rem;
        --background: 0.99 0 0;
        --foreground: 0.15 0 0;
        --card: 1 0 0;
        --card-foreground: 0.15 0 0;
        --popover: 1 0 0;
        --popover-foreground: 0.15 0 0;
        --primary: 0.55 0.20 264;
        --primary-foreground: 0.99 0 0;
        --secondary: 0.96 0.01 264;
        --secondary-foreground: 0.15 0 0;
        --muted: 0.96 0.01 264;
        --muted-foreground: 0.50 0.01 264;
        --accent: 0.96 0.01 264;
        --accent-foreground: 0.15 0 0;
        --destructive: 0.58 0.24 27;
        --destructive-foreground: 0.99 0 0;
        --border: 0.92 0.01 264;
        --input: 0.92 0.01 264;
        --ring: 0.55 0.20 264;
        --chart-1: 0.65 0.22 41;
        --chart-2: 0.60 0.12 185;
        --chart-3: 0.40 0.07 227;
        --chart-4: 0.83 0.19 84;
        --chart-5: 0.77 0.19 70;
    }

    .dark {
        --background: 0.10 0.01 264;
        --foreground: 0.98 0 0;
        --card: 0.14 0.01 264;
        --card-foreground: 0.98 0 0;
        --popover: 0.12 0.01 264;
        --popover-foreground: 0.98 0 0;
        --primary: 0.65 0.22 264;
        --primary-foreground: 0.10 0 0;
        --secondary: 0.20 0.02 264;
        --secondary-foreground: 0.98 0 0;
        --muted: 0.20 0.02 264;
        --muted-foreground: 0.65 0.01 264;
        --accent: 0.25 0.02 264;
        --accent-foreground: 0.98 0 0;
        --destructive: 0.60 0.22 27;
        --destructive-foreground: 0.98 0 0;
        --border: 0.25 0.02 264;
        --input: 0.25 0.02 264;
        --ring: 0.55 0.15 264;
        --chart-1: 0.49 0.24 264;
        --chart-2: 0.70 0.17 162;
        --chart-3: 0.77 0.19 70;
        --chart-4: 0.63 0.27 304;
        --chart-5: 0.65 0.25 16;
    }

    * {
        @apply border-border;
    }
    
    body {
        @apply bg-background text-foreground;
        font-feature-settings: "rlig" 1, "calt" 1;
    }
}

@layer utilities {
    .drag-over {
        @apply ring-2 ring-primary ring-offset-2;
    }

    /* Disable text selection for interactive drag/long-press containers */
    .no-text-select {
        user-select: none;
        -webkit-user-select: none;
        -webkit-touch-callout: none;
    }

    /* Re-enable text selection for inputs/textareas inside no-text-select containers */
    .no-text-select input,
    .no-text-select textarea,
    .no-text-select [contenteditable="true"] {
        user-select: text;
        -webkit-user-select: text;
        -webkit-touch-callout: default;
    }

    /* Safe area support for iOS devices with notches */
    .safe-area-bottom {
        padding-bottom: env(safe-area-inset-bottom);
    }

    /* Streak visualization effects - GPU-accelerated with transform and opacity */
    
    /* 2-7 days: Subtle blue shimmer animation */
    @keyframes shimmer-blue {
        0%, 100% {
            box-shadow: 0 0 8px oklch(0.65 0.15 240 / 0.3);
            transform: translateZ(0);
        }
        50% {
            box-shadow: 0 0 16px oklch(0.65 0.15 240 / 0.5);
            transform: translateZ(0);
        }
    }

    .streak-shimmer-blue {
        position: relative;
        animation: shimmer-blue 2.5s ease-in-out infinite;
        will-change: transform;
    }

    .streak-shimmer-blue::before {
        content: '';
        position: absolute;
        inset: -1px;
        border-radius: inherit;
        padding: 1px;
        background: linear-gradient(135deg, 
            oklch(0.65 0.15 240 / 0.4), 
            oklch(0.70 0.12 240 / 0.2),
            oklch(0.65 0.15 240 / 0.4)
        );
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        pointer-events: none;
        opacity: 0.8;
        will-change: opacity;
    }

    /* 8-30 days: Gradient shift with sparkle effect (blue â†’ purple) */
    @keyframes gradient-shift {
        0% {
            background-position: 0% 50%;
            transform: translateZ(0);
        }
        50% {
            background-position: 100% 50%;
            transform: translateZ(0);
        }
        100% {
            background-position: 0% 50%;
            transform: translateZ(0);
        }
    }

    @keyframes sparkle {
        0%, 100% {
            opacity: 0;
            transform: scale(0.8) translateZ(0);
        }
        50% {
            opacity: 1;
            transform: scale(1) translateZ(0);
        }
    }

    .streak-sparkle-purple {
        position: relative;
        background: linear-gradient(
            135deg,
            oklch(0.65 0.15 240 / 0.15),
            oklch(0.60 0.18 280 / 0.15),
            oklch(0.65 0.15 240 / 0.15)
        );
        background-size: 200% 200%;
        animation: gradient-shift 3s ease infinite;
        will-change: transform;
    }

    .streak-sparkle-purple::before {
        content: '';
        position: absolute;
        inset: -1px;
        border-radius: inherit;
        padding: 1px;
        background: linear-gradient(135deg, 
            oklch(0.65 0.15 240 / 0.5), 
            oklch(0.60 0.18 280 / 0.6),
            oklch(0.65 0.15 240 / 0.5)
        );
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        pointer-events: none;
        will-change: opacity;
    }

    .streak-sparkle-purple::after {
        content: 'âœ¨';
        position: absolute;
        top: 4px;
        right: 4px;
        font-size: 10px;
        animation: sparkle 2s ease-in-out infinite;
        pointer-events: none;
        will-change: transform, opacity;
    }

    /* > 30 days: Golden glow with pulse effect (mastery) */
    @keyframes glow-pulse {
        0%, 100% {
            box-shadow: 0 0 12px oklch(0.75 0.15 85 / 0.4), 
                        0 0 24px oklch(0.75 0.15 85 / 0.2);
            transform: scale(1) translateZ(0);
        }
        50% {
            box-shadow: 0 0 20px oklch(0.75 0.15 85 / 0.6), 
                        0 0 36px oklch(0.75 0.15 85 / 0.3);
            transform: scale(1.01) translateZ(0);
        }
    }

    .streak-glow-gold {
        position: relative;
        background: linear-gradient(
            135deg,
            oklch(0.85 0.12 85 / 0.15),
            oklch(0.80 0.14 75 / 0.15),
            oklch(0.85 0.12 85 / 0.15)
        );
        animation: glow-pulse 2s ease-in-out infinite;
        will-change: transform;
    }

    .streak-glow-gold::before {
        content: '';
        position: absolute;
        inset: -2px;
        border-radius: inherit;
        padding: 2px;
        background: linear-gradient(135deg, 
            oklch(0.80 0.15 85 / 0.7), 
            oklch(0.85 0.12 75 / 0.5),
            oklch(0.80 0.15 85 / 0.7)
        );
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        pointer-events: none;
        will-change: opacity;
    }

    .streak-glow-gold::after {
        content: 'ðŸ‘‘';
        position: absolute;
        top: 4px;
        right: 4px;
        font-size: 12px;
        animation: sparkle 2.5s ease-in-out infinite;
        pointer-events: none;
        will-change: transform, opacity;
    }
}
